# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [1.3.0] - 2024-05-19

### Feature

- Introduce pwl, remove lazy static where used. (#47)
- Refactor Creature response according to new db and remastered (#48)
- Introduce Creature Role (#49)
- Refactor DB communication, remove moka cache (#51)

## [1.2.0] - 2024-01-17

### Feature

- Allow variants on encounter generation (#37)

### Fixed

- Change default from any to no alignment (#39)
- Any not converted correctly from db string (#40)

## [1.0.0] - 2023-11-16

### Added

- Add gunicorn support, expand config usage, fix docker image
- Add encounter info: encounter difficulty, exp and difficulty thresholds
- Add endpoint to fetch creature fields (family, rarity, size, alignment), page size must be greater or equal than 1, generalize fetch_keys redis_handler method
- Add method to procedurally create endpoints ending with or without /
- Add weak and elite endpoints
- Add melee, ranged, spell caster and sources fields. add melee, ranged and spell caster filters (#14)
- Add health controller
- Add get filter routers, use dbcache filters field, separate a little bit the cache logic and router initialization
- Add elite and weak modifier. Complete bestiary
- Add swagger at swagger-ui endpoint
- Add get_encounter_info logic

### Changed

- Flake8 refactor
- Introduce list validation, change endpoint name to a more Rest like naming scheme
- Expand Creature object
- Bump version
- Refactor following ruff guidelines (#13)
- Refactor from rocket to actix-web
- Run clippy linter, add pre-commit, add Dockerfile
- Update bestiary swagger, refactor id endpoint
- Allow cors, optimize dockerignore, fix Dockerfile
- Rename difficulty to challenge, return metadata enums in UPPERCASE
- Return enum fields in caps and null as vec result when enc gen failed with error. Remove various debug
- Rename encounter_challenge to challenge, format any
- Refactor get single creature to not call redis each time
- Update readme
- Add valid rust actions
- 1.0.0 release (#32)

### Feature

- Backend is now deployment ready using docker and fly.io
- Implement random encounter generator, redis_handler can now fetch ids that pass filters
- Allow encounter generation with no filter, difficulty is randomized and the rest ignored
- Introduce get creature API, add filter name to list API
- Add sort and label filters  (#6)
- Add level and hp (min, max) filters (#9)
- Refactor using rust
- Implement cache (that needs to be refactored, it's ported 1:1 from python code)
- Implement full feature routing for bestiary list, with filters and default values.
- Allow request without pagination
- Implement encounter generation in rust (#16)
- Refactor cache to make it more rusty. This has the problem that it will have a slow first call every 24hours for one unlucky user
- Parse sources and return them correctly
- Parse complex sources strings
- Implement traits (#19)
- Implement creature types (#21)
- Implement multiple filter values (#23)
- Implement cache control (#25)
- Implement SQLite db (#28)
- Implement source endpoint (#30)
- Implement generator filtering by number of creatures (#31)

### Fixed

- Now get_bestiary returns json instead of string
- Handle difference between negative levels when calculating encounter info
- Next element wrong address
- Allow CORS calls
- Simplify calculate_encounter_difficulty, fix logical bug with trivial difficulty
- Populate new_ids_dict correctly (#7)
- Side effect on creature cache (#11)
- Refactor to handle correctly json body on post
- Use of scan instead of keys, that raised an error when the number of keys is high
- Creature_id endpoint overriding rarities, families, size, alignment etc
- Encounter info returning impossible on trivial encounters
- Pagination taking more element than requested
- Ln string not in caps
- Encounter info broken with negative enemies
- Set filtering was doing union operation instead of intersection
- Filter correctly vectors containing integer with value < -1

[1.3.0]: https://github.com///compare/v1.2.0..v1.3.0
[1.2.0]: https://github.com///compare/v1.0.0..v1.2.0

<!-- generated by git-cliff -->
